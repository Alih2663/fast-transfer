<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="utf-8">
  <title>Fast Transfer</title>
  <link rel="stylesheet" href="/static/design.css">

  <script> 
  async function uploadFile(event) { 
    event.preventDefault();
    const fileInput = document.getElementById('actual-btn');
    const file = fileInput.files[0];
    const uploadButton = document.querySelector('button[type="submit"]');
    const form = document.getElementById('upload-form');
    const linkContainer = document.getElementById("link-container");

    if (!file) {
      alert("Please select file");
      return;
    }

    uploadButton.disabled = true;
    uploadButton.textContent = "Uploading...";

    const formData = new FormData();
    formData.append("file", file);

    try {
      const response = await fetch("/upload", {
        method: "POST",
        body: formData
      });

      if (response.ok) {
        const data = await response.json();
        const downloadPageLink = `${window.location.origin}${data.share_url}`;

        form.style.display = "none";

        linkContainer.innerHTML = `
          <h3>Download Link:</h3>
          <input type="text" id="download-link" value="${downloadPageLink}" readonly />
          <button onclick="copyLink()">Copy</button>
        `;
      } else {
        alert("Upload failed!");
        uploadButton.disabled = false;
        uploadButton.textContent = "Upload";
      }
    } catch (err) {
      alert("Error: " + err.message);
      uploadButton.disabled = false;
      uploadButton.textContent = "Upload";
    }
  }

  function copyLink() {
    const linkInput = document.getElementById("download-link");
    linkInput.select();
    linkInput.setSelectionRange(0, 99999);
    document.execCommand("copy");
    alert("Link copied: " + linkInput.value);
  }
</script>


</head>
<body>

  <h1>FAST TRANSFER</h1>
<div class="center"> 
  <form id="upload-form" onsubmit="uploadFile(event)">
    <input type="file" name="file" id="actual-btn" required />
    <button type="submit">Upload</button>
  </form>

  <div id="link-container"></div>
</div>


  <div id="link-container"></div>

</body>
</html>